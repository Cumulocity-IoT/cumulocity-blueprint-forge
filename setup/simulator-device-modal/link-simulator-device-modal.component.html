<wizard activeStepId="blueprint-forge-menu">
    <wizard-step stepId="blueprint-forge-menu">
        <div class="modal-header text-center bg-primary" style="color: var(--brand-dark, #000);">
            <h4>Link Simulator</h4>
        </div>
        <div class="modal-inner-scroll">
                    <ng-container >
                        <a class="list-group-item clickable"  (click)="createSimulator('device')">
                            <span>New Device/Asset</span>
                        </a>

                        <a class="list-group-item clickable"  (click)="createSimulator('group')">
                            <span>New Group</span>
                        </a>

                        <div *ngIf="groupEnabled" class="group-input">
                            <label >Number of devices</label>
                            <input name="numberofDevices" class="form-control"
                                [(ngModel)]="numberofDevices" required style="width: 100%">
                        </div>
                    </ng-container>
        </div>
        <div class="c8y-wizard-footer">
            <!-- <button class="btn btn-primary" (click)="wizard.selectStep('show-measurement')"
                >Next <i c8yIcon="chevron-right"></i> </button> -->
            <button class="btn btn-default" (click)="bsModalRef.hide()">Cancel</button>
        </div>
    </wizard-step>

    <wizard-step stepId="show-measurement">
        <div class="row">
            <div class="col-xs-12 col-sm-5 col-md-5">
                <div class="form-group">
                    <label for="dtdlFile"><span>Uploaded DTDL File</span></label>
                    <div style="display: inline-flex;">
                     <div style="color:blue;margin: 5px;">filename.pdf</div>
                    </div>
                </div>
            </div>

            <div class="col-xs-12 col-sm-4 col-md-4">
                <div class="form-group">
                   <label for="name"><span>Name</span></label>
                   <input type="text" class="form-control" id="name" name="name" placeholder="e.g. My First Simulator (required)" required autofocus [(ngModel)]="deviceName">
                </div>
               </div>
               <div class="col-xs-12 col-sm-3 col-md-3">
                <div class="form-group">
                   <label for="name"><span>Filter</span></label>
                   <button class="btn btn-xs" id="measurementFilterEnabled" name="measurementFilterEnabled" [(ngModel)]="measurementFilterEnabled" 
                   (ngModelChange)="measurementFilterEnabledChange()" 
                   btnCheckbox>{{measurementFilterEnabled? 'Telemetry' : 'All fields' }}</button>
               </div>
               </div>
        </div>

        <div class="form-group">
            <label for="dtdlDevice"><span>Select Measurements</span>  </label>  Config value {{ config | json}}
            <ng-select [items]="configModel" bindLabel="measurementName" name="measurementSelect" required [multiple]="true" [closeOnSelect]="false" [searchable]="true"
            placeholder="Select Measurements" [(ngModel)]="config.dtdlModelConfig" >
            </ng-select>
       </div>


       <!-- <div class="form-group">
        <accordion  [isAnimated]="true" [closeOthers]="true">
            <accordion-group panelClass="dtdl-simulator-measurement-panel"  *ngFor="let model of config.dtdlModelConfig;let index = index"  #dtdlGroup>
                <button class="btn btn-link btn-block clearfix" accordion-heading type="button">
                    <div class="pull-left float-left">{{model.measurementName}}</div>
                    <span class="float-right pull-right"><i *ngIf="dtdlGroup.isOpen" class="fa fa-caret-up"></i>
                    <i *ngIf="!dtdlGroup.isOpen" class="fa fa-caret-down"></i></span>
                </button>
                <div class="col-xs-12 col-sm-4 col-md-4">
                    <div class="measurement-accordion">
                        <label for="simulationType"><span>Simulation Type</span></label>
                        <select name="simulationType{{model.id}}"  [(ngModel)]="model.simulationType" required  (ngModelChange)="changeSimulationType(model)">
                            <option value="randomValue" >Random Value</option>
                            <option value="valueSeries" >Value Series</option>
                            <option value="randomWalk" >Random Walk</option>
                            <option value="positionUpdate" >Position Update</option>
                            <option value="eventCreation" >Event Creation</option>
                        </select>
                    </div>     
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" *ngIf="!model.isFieldModel && model.simulationType !== 'positionUpdate' && model.simulationType !== 'eventCreation'">
                    <div class="measurement-accordion">
                        <label for="fragment"><span>Fragment</span></label>
                        <input type="text" class="form-control"  name="fragment{{model.id}}" placeholder="e.g. temperature_measurement (required)" required autofocus [(ngModel)]="model.fragment" (ngModelChange)="changeFragment(model)">
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" *ngIf="model.simulationType !== 'positionUpdate' && model.simulationType !== 'eventCreation'">
                    <div class="measurement-accordion">
                        <label for="series"><span>Series</span></label>
                        <input type="text" class="form-control" name="series{{model.id}}" placeholder="e.g. T (required)" required autofocus [(ngModel)]="model.series" (ngModelChange)="changeSeries(model)">
                    </div>
                </div>

                <ng-container [ngSwitch]="model.simulationType">
                    <ng-container *ngSwitchCase="'randomValue'">
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="minvalue"><span>Minimum Value</span></label>
                                <input type="number" class="form-control"  name="minvalue{{model.id}}" placeholder="e.g. 10 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].minValue">
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="maxvalue"><span>Maximum Value</span></label>
                                <input type="number" class="form-control"  name="maxvalue{{model.id}}" placeholder="e.g. 20 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].maxValue">
                            </div>
                        </div>
                        <ng-container *ngIf="model.alternateConfigs.opEnabled">
                            <div class="col-xs-12 col-sm-4 col-md-4">
                                <div class="measurement-accordion">
                                    <label for="match_{{model.id}}"><span>Matching</span></label>
                                    <input type="text" class="form-control" id="match_{{model.id}}" name="match_{{model.id}}" placeholder="e.g. WINDY" required [(ngModel)]="model.alternateConfigs.operations[0].matchingValue">
                                </div>
                            </div>
                        </ng-container>
                    </ng-container>
                    <ng-container *ngSwitchCase="'positionUpdate'">
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="latitude"><span>Latitude Value</span></label>
                                <input type="text" class="form-control"  name="latitude{{model.id}}" placeholder="e.g. 40.66,50.40 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].latitude">
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="altitude"><span>Altitude Value</span></label>
                                <input type="text" class="form-control"  name="altitude{{model.id}}" placeholder="e.g. 40.66,50.40 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].altitude">
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="longitude"><span>Longitude value</span></label>
                                <input type="text" class="form-control"  name="longitude{{model.id}}" placeholder="e.g. 40.66,50.40 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].longitude">
                            </div>
                        </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'eventCreation'">
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="eventType"><span>Event Type</span></label>
                                <input type="text" class="form-control"  name="eventType{{model.id}}" placeholder="c8y_locationUpdate,c8y_BeaconUpdate" required [(ngModel)]="model.alternateConfigs.operations[0].eventType">
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="eventText"><span>Event Text</span></label>
                                <input type="text" class="form-control"  name="eventText{{model.id}}" placeholder="c8y_locationUpdate,c8y_BeaconUpdate (required)" required [(ngModel)]="model.alternateConfigs.operations[0].eventText">
                            </div>
                        </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'valueSeries'">
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="value"><span>Value</span></label>
                                <input type="text" class="form-control" id="value" name="value{{model.id}}" placeholder="e.g. 15,20,30 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].value">
                            </div> 
                        </div>
                        <ng-container *ngIf="model.alternateConfigs.opEnabled">
                            <div class="col-xs-12 col-sm-4 col-md-4">
                                <div class="measurement-accordion">
                                    <label for="match_{{model.id}}"><span>Matching</span></label>
                                    <input type="text" class="form-control" id="match_{{model.id}}" name="match_{{model.id}}" placeholder="e.g. WINDY" required [(ngModel)]="model.alternateConfigs.operations[0].matchingValue">
                                </div>
                            </div>
                        </ng-container>
                    </ng-container>
                    <ng-container *ngSwitchCase="'randomWalk'">
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                            <label for="startingvalue"><span>Starting Value</span></label>
                            <input type="number" class="form-control" id="startingvalue" name="startingvalue{{model.id}}" placeholder="e.g. 10 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].startingValue">
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="maxdelta"><span>Maximum Change Amount</span></label>
                                <input type="number" class="form-control" id="maxdelta" name="maxdelta{{model.id}}" min="0" placeholder="e.g. 10 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].maxDelta">
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="minvalue"><span>Minimum Value</span></label>
                                <input type="number" class="form-control"  name="minvalue{{model.id}}" placeholder="e.g. 10 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].minValue">
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <div class="measurement-accordion">
                                <label for="maxvalue"><span>Maximum Value</span></label>
                                <input type="number" class="form-control"  name="maxvalue{{model.id}}" placeholder="e.g. 20 (required)" required [(ngModel)]="model.alternateConfigs.operations[0].maxValue">
                            </div>
                        </div>
                        <ng-container *ngIf="model.alternateConfigs.opEnabled">
                            <div class="col-xs-12 col-sm-4 col-md-4">
                                <div class="measurement-accordion">
                                    <label for="match_{{model.id}}"><span>Matching</span></label>
                                    <input type="text" class="form-control" id="match_{{model.id}}" name="match_{{model.id}}" placeholder="e.g. WINDY" required [(ngModel)]="model.alternateConfigs.operations[0].matchingValue">
                                </div>
                            </div>
                        </ng-container>
                    </ng-container>
                </ng-container>

                <div class="col-xs-12 col-lg-12" *ngIf="!config.isGroup && model.simulationType !== 'positionUpdate' && model.simulationType !== 'eventCreation' ">
                    <div class="measurement-accordion">
                        <label class="c8y-checkbox">
                            <input type="checkbox" name="opEnabled{{model.id}}" [(ngModel)]="model.alternateConfigs.opEnabled" (click)="checkDefaultOperation(model)"/>
                            <span></span>
                            <span>Controlled by operation</span>
                        </label>
                    </div>
                </div>

          
                <div class="col-xs-12 col-lg-12">   
                    <ng-container *ngIf="model.alternateConfigs.opEnabled">
                        <accordion  [isAnimated]="true" [closeOthers]="true">
                            <accordion-group panelClass="op-simulator-panel" #opGroup>
                                <button class="btn btn-link btn-block clearfix" accordion-heading type="button">
                                    <div class="pull-left float-left">Operation details</div>
                                    <span class="float-right pull-right"><i *ngIf="opGroup.isOpen" class="fa fa-caret-up"></i>
                                    <i *ngIf="!opGroup.isOpen" class="fa fa-caret-down"></i></span>
                                </button>
                                <div class="col-xs-6 col-lg-6">
                                    <div class="measurement-accordion">
                                        <label for="opSource"><span>Operation Source</span></label>
                                        <device-selector id="opSource" name="opSource" [(value)]="model.alternateConfigs.opSourceName" [placeHolder]="'Type your Device Name'" [required]="true" (selectedDevice)= "getOperationDevice($event,model)"></device-selector>
                                    </div>
                                </div>
                                <div class="col-xs-6 col-lg-6">
                                    <div class="measurement-accordion">
                                        <label for="opPayload"><span>Payload Key</span></label>
                                        <input type="text" class="form-control" id="opPayload" name="opPayload" placeholder="e.g. c8y_command.text" required autofocus [(ngModel)]="model.alternateConfigs.payloadFragment">
                                    </div>
                                </div>
                                <div class="col-xs-12 col-lg-12">
                                    <div class="measurement-accordion">
                                        <label class="c8y-checkbox">
                                            <input type="checkbox" id="opReply" name="opReply" [(ngModel)]="model.alternateConfigs.opReply" />
                                            <span></span>
                                            <span>Mark operation handled</span>
                                        </label>
                                    </div>
                                </div>
                                <hr /> 
                                <ng-container *ngFor="let op of model.alternateConfigs.operations; let i = index">
                                    <ng-container *ngIf="i > 0">
                                        <div class="col-xs-6 col-lg-6">
                                            <div class="measurement-accordion">
                                                <label for="opMatch_{{i}}"><span>Matching</span></label>
                                                <input type="text" class="form-control" id="opMatch{{model.id}}_{{i}}" name="opMatch{{model.id}}_{{i}}" placeholder="e.g. WINDY" required [(ngModel)]="op.matchingValue">
                                            </div>
                                        </div>
                                        
                                        <ng-container [ngSwitch]="model.simulationType">
                                            <ng-container *ngSwitchCase="'randomValue'">
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="minvalue"><span>Minimum Value</span></label>
                                                        <input type="number" class="form-control"  name="minvalue{{model.id}}_{{i}}" placeholder="e.g. 10 (required)" required [(ngModel)]="op.minValue">
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="maxvalue"><span>Maximum Value</span></label>
                                                        <input type="number" class="form-control"  name="maxvalue{{model.id}}_{{i}}" placeholder="e.g. 20 (required)" required [(ngModel)]="op.maxValue">
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="'positionUpdate'">
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="latitude"><span>Latitude Value</span></label>
                                                        <input type="text" class="form-control"  name="latitude{{model.id}}_{{i}}" placeholder="e.g. 40.66,50.40 (required)" required [(ngModel)]="op.latitude">
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="altitude"><span>Altitude Value</span></label>
                                                        <input type="text" class="form-control"  name="altitude{{model.id}}_{{i}}" placeholder="e.g. 40.66,50.40 (required)" required [(ngModel)]="op.altitude">
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="longitude"><span>Longitude value</span></label>
                                                        <input type="text" class="form-control"  name="longitude{{model.id}}_{{i}}" placeholder="e.g. 40.66,50.40 (required)" required [(ngModel)]="op.longitude">
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="'eventCreation'">
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="eventType"><span>Event Type</span></label>
                                                        <input type="text" class="form-control"  name="eventType{{model.id}}_{{i}}" placeholder="c8y_locationUpdate,c8y_BeaconUpdate" required [(ngModel)]="op.eventType">
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="eventText"><span>Event Text</span></label>
                                                        <input type="text" class="form-control"  name="eventText{{model.id}}_{{i}}" placeholder="c8y_locationUpdate,c8y_BeaconUpdate (required)" required [(ngModel)]="op.eventText">
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="'valueSeries'">
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="value"><span>Value</span></label>
                                                        <input type="text" class="form-control" id="value" name="value{{model.id}}_{{i}}" placeholder="e.g. 15,20,30 (required)" required [(ngModel)]="op.value">
                                                    </div> 
                                                </div>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="'randomWalk'">
                                                <div class="col-xs-12 col-sm-4 col-md-6">
                                                    <div class="measurement-accordion">
                                                    <label for="startingvalue"><span>Starting Value</span></label>
                                                    <input type="number" class="form-control" id="startingvalue" name="startingvalue{{model.id}}_{{i}}" placeholder="e.g. 10 (required)" required [(ngModel)]="op.startingValue">
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-5">
                                                    <div class="measurement-accordion">
                                                        <label for="maxdelta"><span>Maximum Change Amount</span></label>
                                                        <input type="number" class="form-control" id="maxdelta" name="maxdelta{{model.id}}_{{i}}" min="0" placeholder="e.g. 10 (required)" required [(ngModel)]="op.maxDelta">
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-3">
                                                    <div class="measurement-accordion">
                                                        <label for="minvalue"><span>Minimum Value</span></label>
                                                        <input type="number" class="form-control"  name="minvalue{{model.id}}_{{i}}" placeholder="e.g. 10 (required)" required [(ngModel)]="op.minValue">
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-4">
                                                    <div class="measurement-accordion">
                                                        <label for="maxvalue"><span>Maximum Value</span></label>
                                                        <input type="number" class="form-control"  name="maxvalue{{model.id}}_{{i}}" placeholder="e.g. 20 (required)" required [(ngModel)]="op.maxValue">
                                                    </div>
                                                </div>
                                            </ng-container>
                                        </ng-container>
                                        <div class="row">
                                            <div class="col-xs-12 col-lg-12">
                                                <button class="btn btn-link btn-block" type="button" (click)="deleteDtDLOperation(model,i)">
                                                    <div class="pull-left float-left">Remove condition</div>
                                                </button>
                                            </div>
                                            <div class="col-xs-12 col-lg-12">
                                                <hr />   
                                            </div>
                                        </div>
                                    </ng-container>
                                </ng-container>
                                <button class="btn btn-link btn-block" type="button" (click)="newOperation(model,'dtdl_value',model.alternateConfigs.operations.length)">
                                    <div class="pull-left float-left">Add condition</div>
                                </button>
                            </accordion-group>
                        </accordion>
                    </ng-container>
                </div>
               

                <div class="col-xs-12 col-sm-4 col-md-4" *ngIf="model.simulationType !== 'positionUpdate' && model.simulationType !== 'eventCreation'">
                    <div class="measurement-accordion">
                        <label for="unit"><span>Unit</span></label>
                        <input type="text" class="form-control"  name="unit{{model.id}}" placeholder="e.g. C (optional)" [(ngModel)]="model.unit"  (ngModelChange)="changeUnit(model)">
                    </div>        
                </div>
            </accordion-group>
        </accordion>
    </div> -->

       <div class="c8y-wizard-footer">
        <!-- <button class="btn btn-primary" (click)="wizard.selectStep('show-measurement')"
            >Next <i c8yIcon="chevron-right"></i> </button> -->
        <button class="btn btn-default" (click)="bsModalRef.hide()">Cancel</button>
    </div>


      
   
    </wizard-step>
</wizard> 

